{% extends 'layout/base.html' %} {% block content %}
<div class="container">
  <h2>Add New Flight</h2>
  <div class="auth-container">
    <form
      method="POST"
      action="{{ url_for('manager.add_flight') }}"
      class="staff-form"
    >
      <!-- Basic Data -->
      <h3>Flight Details</h3>
      <div class="staff-form-grid">
        <div class="form-group">
          <label class="form-label form-label--required">Source Airport:</label>
          <select name="source_id" id="source_id" required class="form-select">
            {% for airport in airports %}
            <option value="{{ airport.airport_id }}">
              {{ airport.airport_name }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="form-group">
          <label class="form-label form-label--required">Destination Airport:</label>
          <select name="dest_id" id="dest_id" required class="form-select">
            {% for airport in airports %}
            <option value="{{ airport.airport_id }}" {% if loop.index == 2 %}selected{% endif %}>
              {{ airport.airport_name }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="form-group">
          <label class="form-label form-label--required">Departure Time:</label>
          <input type="datetime-local" name="departure_time" id="departure_time" required class="form-input" min="{{ current_datetime }}" />
        </div>
      </div>

      <!-- Aircraft -->
      <h3>Aircraft</h3>
      <div class="form-group">
        <label class="form-label form-label--required">Select Aircraft:</label>
        <select name="aircraft_id" id="aircraft_id" required class="form-select">
          {% for aircraft in aircrafts %}
          <option value="{{ aircraft.aircraft_id }}">
            {{ aircraft.manufacturer }} (ID: {{ aircraft.aircraft_id }})
          </option>
          {% endfor %}
        </select>
      </div>

      <!-- Crew -->
      <h3>Crew Assignment <span style="color: red">*</span></h3>
      <div class="staff-form-grid">
        <div class="form-group">
          <label class="form-label">Pilots:</label>
          <div id="pilots_container" class="checkbox-list">
            <p class="text-muted small">Select flight details to see availability</p>
            {% for pilot in pilots %}
            <label class="checkbox-label">
              <input
                type="checkbox"
                name="crew_ids"
                value="{{ pilot.id_number }}"
                data-type="pilots"
              />
              <span>{{ pilot.first_name }} {{ pilot.last_name }}</span>
            </label>
            {% endfor %}
          </div>
          <div id="pilots_counter" class="crew-counter"></div>
          <div id="pilots_error" class="crew-error-message" style="display: none;"></div>
        </div>
        <div class="form-group">
          <label class="form-label">Flight Attendants:</label>
          <div id="attendants_container" class="checkbox-list">
            <p class="text-muted small">Select flight details to see availability</p>
            {% for attendant in attendants %}
            <label class="checkbox-label">
              <input
                type="checkbox"
                name="crew_ids"
                value="{{ attendant.id_number }}"
                data-type="attendants"
              />
              <span>{{ attendant.first_name }} {{ attendant.last_name }}</span>
            </label>
            {% endfor %}
          </div>
          <div id="attendants_counter" class="crew-counter"></div>
          <div id="attendants_error" class="crew-error-message" style="display: none;"></div>
        </div>
      </div>

      <!-- Pricing -->
      <h3>Ticket Pricing</h3>
      <div class="staff-form-grid">
        <div class="form-group">
          <label class="form-label form-label--required">Economy Price ($):</label>
          <input type="number" name="economy_price" step="0.01" min="0" required class="form-input" />
        </div>
        <div class="form-group">
          <label class="form-label form-label--required">Business Price ($):</label>
          <input type="number" name="business_price" step="0.01" min="0" required class="form-input" />
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn">Publish Flight</button>
        <a
          href="{{ url_for('manager.manager_dashboard') }}"
          class="btn btn-secondary"
          >Cancel</a
        >
      </div>
    </form>
  </div>
</div>

<script src="{{ url_for('static', filename='js/add_flight.js') }}"></script>
{% endblock %}
